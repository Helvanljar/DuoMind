{% extends "base.html" %}
{% block title %}DuoMind – Report{% endblock %}

{% block content %}
<section class="research-top card">
  <h1 class="research-title">Report</h1>
  {% if query %}
    <p class="muted"><strong>Query:</strong> {{ query }}</p>
  {% endif %}
  {% if created_at %}
    <p class="muted small-status">
      Generated at {{ created_at }}
      {% if verified is not none %}
        · Status:
        {% if verified %}
          <span style="color:#4ade80;">Verified</span>
        {% else %}
          <span style="color:#facc15;">Unverified</span>
        {% endif %}
      {% endif %}
    </p>
  {% endif %}
</section>

<section class="research-layout">
  <div class="research-row">
    <article class="llm-card card">
      <header class="llm-card-head">
        <div class="llm-badge">A</div>
        <div>
          <h2>Answer (LLM A)</h2>
          {% if model_a %}
            <p class="llm-meta">{{ model_a.provider|default('') }} {{ model_a.model|default('') }}</p>
          {% endif %}
        </div>
      </header>
      <div class="llm-card-body md">
        {{ answer_a_html|safe }}
      </div>
    </article>

    <article class="llm-card card">
      <header class="llm-card-head">
        <div class="llm-badge llm-badge-b">B</div>
        <div>
          <h2>Answer (LLM B)</h2>
          {% if model_b %}
            <p class="llm-meta">{{ model_b.provider|default('') }} {{ model_b.model|default('') }}</p>
          {% endif %}
        </div>
      </header>
      <div class="llm-card-body md">
        {{ answer_b_html|safe }}
      </div>
    </article>
  </div>

  <article class="llm-compare-card card">
    <header>
      <h2>Comparison / Synthesis</h2>
      {% if synthesis and synthesis.summary %}
        <p class="muted" style="margin-top:.4rem;">{{ synthesis.summary }}</p>
      {% endif %}
    </header>

    <div class="compare-cols">
      <div class="compare-col">
        <h3>Agreements</h3>
        <ul class="compare-list">
          {% for item in (synthesis.agreements or []) %}
            <li>{{ item }}</li>
          {% else %}
            <li class="muted">No clear agreements extracted.</li>
          {% endfor %}
        </ul>
      </div>
      <div class="compare-col">
        <h3>Disagreements</h3>
        <ul class="compare-list">
          {% for item in (synthesis.disagreements or []) %}
            <li>{% if item.from %}[{{ item.from }}] {% endif %}{{ item.text }}</li>
          {% else %}
            <li class="muted">No significant disagreements extracted.</li>
          {% endfor %}
        </ul>
      </div>
    </div>

    {% if session_id %}
      <footer style="margin-top:1rem;font-size:.8rem;" class="muted">
        Session ID: <code>{{ session_id }}</code>
      </footer>
    {% endif %}
  </article>
</section>
{% endblock %}
