{% extends "base.html" %}
{% block title %}DuoMind ‚Äì Registrieren{% endblock %}

{% block content %}
<section class="auth-page">
  <div class="auth-card card">
    <h1 class="auth-title">Registrieren</h1>
    <p class="muted">Erstelle ein Konto, um fortzufahren.</p>

    {% set err = request.query_params.get("error", "") %}
    {% if err %}
      <div class="auth-alert show" role="alert" aria-live="polite">
        {% if err == "missing_fields" %}
          Bitte f√ºlle alle Felder aus.
        {% elif err == "password_mismatch" %}
          Die Passw√∂rter stimmen nicht √ºberein.
        {% elif err == "weak_password" %}
          Passwort ist zu schwach. Bitte beachte die Regeln unten.
        {% elif err == "email_exists" %}
          Diese E-Mail ist bereits registriert. Bitte melde dich an.
        {% else %}
          Etwas ist schiefgelaufen. Bitte versuch es erneut.
        {% endif %}
      </div>
    {% endif %}

    <form method="post" action="/auth/register" class="auth-form">
      <label class="auth-label" for="username">Benutzername</label>
      <input
        id="username"
        name="username"
        class="auth-input"
        type="text"
        autocomplete="username"
        placeholder="Benutzername"
        required
        value="{{ request.query_params.get('username','') }}"
      />

      <label class="auth-label" for="email">E-Mail</label>
      <input
        id="email"
        name="email"
        class="auth-input"
        type="email"
        autocomplete="email"
        placeholder="E-Mail"
        required
        value="{{ request.query_params.get('email','') }}"
      />

      <label class="auth-label" for="password">Passwort</label>
      <div class="auth-password">
        <input
          id="password"
          name="password"
          class="auth-input"
          type="password"
          autocomplete="new-password"
          placeholder="Passwort"
          required
        />
        <button type="button" class="eye-btn" aria-label="Toggle password" onclick="togglePw('password')">üëÅ</button>
      </div>

      <label class="auth-label" for="confirm_password">Passwort best√§tigen</label>
      <div class="auth-password">
        <input
          id="confirm_password"
          name="confirm_password"
          class="auth-input"
          type="password"
          autocomplete="new-password"
          placeholder="Passwort best√§tigen"
          required
        />
        <button type="button" class="eye-btn" aria-label="Toggle password" onclick="togglePw('confirm_password')">üëÅ</button>
      </div>

      <p class="muted auth-hint">
        Passwort: mind. 8 Zeichen, 2 Ziffern, 1 Sonderzeichen und 1 Gro√übuchstabe.
      </p>

      <button type="submit" class="btn-primary auth-submit">Registrieren</button>

      <p class="auth-switch">
        <span class="muted">Schon ein Konto?</span>
        <a href="/auth/login-page" class="auth-link auth-link--premium">Anmelden</a>
      </p>
    </form>
  </div>
</section>

<script>
  function togglePw(id){
    const el = document.getElementById(id);
    if (!el) return;
    el.type = (el.type === "password") ? "text" : "password";
  }
</script>
{% endblock %}
